"use strict";(("undefined"==typeof globalThis?self:globalThis).webpackChunkasp_net=("undefined"==typeof globalThis?self:globalThis).webpackChunkasp_net||[]).push([[1401,873],{87486:function(e,t,r){r.d(t,{C3:function(){return i},EY:function(){return s},Fr:function(){return a},s6:function(){return o}});var n=r(13981),a=function(){return n.Z.get("/customer-service/communication-preferences/interrupter/get-interrupter-status")},i=function(e){return n.Z.post("/customer-service/communication-preferences/interrupter/subscribe",e)},o=function(e){return n.Z.post("/customer-service/communication-preferences/interrupter/update-site-preferences",e)},s=function(e,t){return n.Z.get("/customer-service/communication-preferences/interrupter/get-sites?email=".concat(encodeURIComponent(e),"&isKids=").concat(t))}},83329:function(e,t,r){r.d(t,{g:function(){return M}});var n=r(35466),a=r(88390),i=r(87486),o=r(22824),s=r(97357),l=r(83999);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function m(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=function(e){var t,r,u,c=e.interrupterData,p=e.messages,f=e.bannerContainer,v=e.moveCurrentStep,y=e.isMobile,g=e.isKids,h=e.isCanada,S=e.closeInterrupter,C=e.suppressInterrupter,E=e.campaign;localStorage.setItem("EmailSmsStep","step one");var k=b((0,n.useState)(null!==(t=c.email)&&void 0!==t?t:""),2),w=k[0],T=k[1],_=b((0,n.useState)(""),2),I=_[0],O=_[1],B=b((0,n.useState)(!h&&p.showKidsCheckbox),2),N=B[0],M=B[1],x=b((0,n.useState)({email:!1,cellPhone:!1}),2),D=x[0],A=x[1],j=1==a.Z.get("OldEmailSmsInterrupter")&&!0,P=null===(r=window)||void 0===r||null===(r=r.digitalData)||void 0===r||null===(r=r.page)||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.navState,L=null===(u=window)||void 0===u||null===(u=u.digitalData)||void 0===u||null===(u=u.page)||void 0===u||null===(u=u.pageInfo)||void 0===u?void 0:u.brand,F=s.hb.filter((function(e){return e.id===c.interrupterType}))[0],H=s.KB.filter((function(e){return e.name===P&&e.site===L}))[0],K=new l.Z("Communication Preferences Interrupter",F?F.name:"email sms interrupter",H?H.brand:"crate",E,E),V=function(e){var t=document.querySelector(e);t&&t.focus()},Z=function(){return c.interrupterType===s.o1.Combo||c.interrupterType===s.o1.Sms},Y=function(){return c.interrupterType===s.o1.Combo||c.interrupterType===s.o1.Email},q=function(){return Y()&&p.showKidsCheckbox&&!c.isCb2},R=function(){if(c.interrupterType===s.o1.Email)return n.createElement("div",{className:"email-sms-interrupter-form-footer-row"},n.createElement("div",{className:"email-sms-interrupter-form-footer","data-testid":"email-sms-interrupter-form-footer-email",dangerouslySetInnerHTML:{__html:g?p.kidsFormEmailTc:p.formEmailTc}}))},U=function(e,t){var r=null,n=!0;Y()&&(n=(0,o.H)(e));var a=!0;(function(){if(Z())return!0})()&&(a=(0,o.M)(t));var i=d({},D);return i.email=!n,i.cellPhone=!a,r=!0===a&&!1===n?"#email":!0===n&!1===a?"#cellPhone":"#email",A(d({},i),V(r)),n&&a},$=function(){if(U(w,I)){var e=g?p.kidsCreativeId:p.creativeId;(0,i.C3)({creativeId:e,email:w,cellPhone:I,emailSmsInterrupterType:c.interrupterType,bin:p.bin,isKidsPage:g,isAdditionalOptIn:N}).then(z)}},G=function(e){if(13===e.keyCode)return e.preventDefault(),$(),!1},z=function(e){if(e.isSuccess){var t=m(e.brands.brands),r=t.find((function(e){return"kids"===e.brandKeyName.toLowerCase()}))&&!g,n=t.find((function(e){return"core"===e.brandKeyName.toLowerCase()}))&&g,a=e.messages.subscribed,o=function(){return!(!0!==N||!n&&!r)};C(),c.email=w;var l=function(){var t={status:e.subscriptionStatus};return e.isAlreadySubscribedSms&&(t.subscribedSms=!0),e.isAlreadySubscribedEmail&&(t.subscribedEmail=!0),t};""===w?(0,i.Fr)().then((function(e){null!==e.email&&v(l(),e.email,o(),a)})):v(l(),w,o(),a);c.interrupterType===s.o1.Email&&e.isAlreadySubscribedEmail||c.interrupterType===s.o1.Combo&&"both"===e.subscriptionStatus||c.interrupterType===s.o1.Sms&&e.isAlreadySubscribedSms?K.trackEvent("modal","open","subscribed",!1,{step:"step one",email:!!w,phone:!!I,brand:"".concat(H.brand," ").concat(N?"and ".concat(H.brand,"kids"):""),interrupterType:F},e.hashedEmail?e.hashedEmail:"",!0):(K.trackEvent("modal","open","subscribed",!1,{step:"step one",email:!!w,phone:!!I,brand:"".concat(H.brand," ").concat(N?"and ".concat(H.brand,"kids"):""),interrupterType:F},e.hashedEmail?e.hashedEmail:"",!1),c.interrupterType!==s.o1.Sms&&K.trackPreferencesChange("step one",H.brand,"success",H.brand,"".concat(H.brand," ").concat(N?"and ".concat(H.brand,"kids"):""),e.hashedEmail?e.hashedEmail:""))}!1===e.isSuccess&&"Server Error"===e.message&&(v("Server Error"),f.classList.add("had-server-error"))},Q=function(){S("step one","maybe later")},J=n.createElement("div",{className:"email-sms-invalid-input-error"},n.createElement("svg",{className:"icon svg-icon-error",role:"img","aria-label":"Error"},n.createElement("use",{xlinkHref:"#svg-icon-error"})),n.createElement("span",null,"Oops! Enter a valid email address.")),W=n.createElement("div",{className:"email-sms-invalid-input-error"},n.createElement("svg",{className:"icon svg-icon-error",role:"img","aria-label":"Error"},n.createElement("use",{xlinkHref:"#svg-icon-error"})),n.createElement("span",null,"Oops! Enter a valid mobile phone number.")),X=Y()&&n.createElement("div",{className:"row email-sms-interrupter-field-row"},n.createElement("label",{htmlFor:"email"},"Email Address",n.createElement("span",{className:"required"},"required")),n.createElement("input",{"aria-describedby":"emailError",id:"email",maxLength:"80",name:"email",type:"text",className:"input-lg interrupter-field ".concat(D.email?"input-validation-error interrupter-field-error":"input-validation-valid"),"data-testid":"email-sms-interrupter-email-field",onChange:function(e){var t=e.target.value;T(t);var r=d({},D);r.email=!1,A(d({},r),V("#email"))},value:w,onKeyDown:G}),n.createElement("div",{id:"emailError",className:"field-validation-error ".concat(D.email?"":"hidden"),"data-testid":"email-sms-interrupter-email-error"},D.email&&J)),ee=q()&&n.createElement("div",{className:"row email-sms-interrupter-field-row kids-interrupter-checkbox-row"},n.createElement("input",{type:"checkbox",className:"email-sms-kids-checkbox a11y-checkbox","data-testid":"email-sms-interrupter-email-kids-field",id:"emailadditionalOptIn",name:"emailadditionalOptIn",defaultChecked:N,onChange:function(e){var t=e.target.checked;M(t)}}),n.createElement("label",{className:"a11y-checkbox-label",htmlFor:"emailadditionalOptIn"},g?p.crateCheckboxLabelMessage:p.kidsCheckboxLabelMessage)),te=(c.isCb2||(c.interrupterType,s.o1.Sms),Z()&&n.createElement("div",{className:"row email-sms-interrupter-field-row"},n.createElement("label",{htmlFor:"cellPhone"},"Mobile Phone Number",n.createElement("span",{className:"required"},"required")),n.createElement("input",{"aria-describedby":"cellPhoneError",id:"cellPhone",maxLength:"20",name:"cellPhone",type:"text",className:"input-lg interrupter-field ".concat(D.cellPhone?"input-validation-error interrupter-field-error":"input-validation-valid"),"data-testid":"email-sms-interrupter-cell-phone-field",onChange:function(e){var t=e.target.value;O(t);var r=d({},D);r.cellPhone=!1,A(d({},r),V("#cellPhone"))},onKeyDown:G,value:I}),n.createElement("div",{id:"cellPhoneError",className:"field-validation-error ".concat(D.cellPhone?"":"hidden"),"data-testid":"email-sms-interrupter-cell-phone-error"},D.cellPhone&&W))),re=n.createElement(n.Fragment,null);re=!Y()&&Z()&&y?n.createElement("button",{type:"button",className:"button button-lg button-primary button-next email-sms-interrupter-form-submit-button","data-testid":"email-sms-interrupter-form-mobile-only-submit",onClick:function(){var e=navigator.userAgent.toLocaleLowerCase().includes("iphone"),t=g?p.kidsShortCode:p.shortCode,r=g?p.kidsSmsTextMessage:p.smsTextMessage,n="sms://".concat(t,"/").concat(e?"&":"?","body=").concat(encodeURIComponent(r));K.trackEvent("modal","open","subscribed",!1,{step:"step one",email:!1,phone:I,brand:void 0!==H&&H?H.brand:"",interrupterType:F}),window.open(n),v()}},y?p.mobileSmsButton:p.formButton,n.createElement("span",{className:"sr-only"},"(opens sms messaging app)")):n.createElement("button",{type:"button",className:"button button-lg button-primary button-next email-sms-interrupter-form-submit-button","data-testid":"email-sms-interrupter-form-submit",onClick:$},p.formButton);var ne;return n.createElement("form",null,n.createElement("div",{className:"".concat(Y()&&!Z()?"email-sms-interrupter-email-only-form":""," \n            ").concat(!Y()&&Z()?"email-sms-interrupter-phone-only-form":"","\n            email-sms-interrupter-form"),"data-testid":"email-sms-interrupter-form-step"},n.createElement("h2",{className:"email-sms-interrupter-title-text","data-testid":"email-sms-interrupter-title"},(ne=p.titleCta,c.interrupterType===s.o1.Sms&&void 0!==p.smsTitleCta?ne=p.smsTitleCta:c.interrupterType===s.o1.Email&&void 0!==p.emailTitleCta&&(ne=p.emailTitleCta),ne)),n.createElement("div",{className:"email-sms-interrupter-form-message","data-testid":"email-sms-interrupter-form-message"},c.interrupterType===s.o1.Combo&&p.formComboTypeCta,c.interrupterType===s.o1.Email&&p.formEmailTypeCta,c.interrupterType===s.o1.Sms&&p.formSMSTypeCta),function(){if(c.interrupterType===s.o1.Sms)return n.createElement("div",{className:"email-sms-interrupter-form-footer-row email-sms-terms-above-button"},n.createElement("div",{className:"email-sms-interrupter-form-footer","data-testid":"email-sms-interrupter-form-footer-sms",dangerouslySetInnerHTML:{__html:g?p.kidsFormSmsTc:p.formSmsTc}}))}(),n.createElement("div",{className:"email-sms-interrupter-form-fields-group \n                     ".concat(c.interrupterType===s.o1.Email&&q()?"email-only-interrupter-with-checkbox-fields-group":"","\n                    ")},X,ee,y&&Z()&&!Y()?n.createElement(n.Fragment,null):te,function(){if(c.interrupterType===s.o1.Combo)return n.createElement("div",{className:"email-sms-interrupter-form-footer-row email-sms-terms-above-button"},n.createElement("div",{className:"email-sms-interrupter-form-footer","data-testid":"email-sms-interrupter-form-footer-combo",dangerouslySetInnerHTML:{__html:g?p.kidsFormTc:p.formTc}}))}(),y&&R(),n.createElement("div",null,n.createElement("div",{className:"".concat(y&&Z()&&!Y()&&"mobile-sms-only-submit"," email-sms-interrupter-form-submit-row")},re,j?n.createElement(n.Fragment,null):n.createElement("button",{type:"button",id:"email-sms-maybe-later-button",className:"button button-lg button-secondary button-next email-sms-maybe-later-button",onClick:Q},"Maybe Later")))),y&&Z()&&!Y()?n.createElement("div",{className:"email-sms-interrupter-form-submit-row"},re,j?n.createElement(n.Fragment,null):n.createElement("button",{type:"button",id:"email-sms-maybe-later-button",className:"button button-lg button-secondary button-next email-sms-maybe-later-button",onClick:Q},"Maybe Later")):n.createElement(n.Fragment,null),!y&&R()))},g=function(e){var t,r,a=e.messages,i=e.interrupterData,o=e.campaign,u=null===(t=window)||void 0===t||null===(t=t.digitalData)||void 0===t||null===(t=t.page)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t.navState,m=null===(r=window)||void 0===r||null===(r=r.digitalData)||void 0===r||null===(r=r.page)||void 0===r||null===(r=r.pageInfo)||void 0===r?void 0:r.brand,c=s.hb.filter((function(e){return e.id===i.interrupterType}))[0],d=s.KB.filter((function(e){return e.name===u&&e.site===m}))[0],p=new l.Z("Communication Preferences Interrupter",c?c.name:"email sms interrupter",d?d.brand:"crate",o,o),b=localStorage.getItem("EmailSmsStep");p.trackEvent("modal","open","error",!1,{step:null!==b&&b});return n.createElement("div",{className:"email-sms-interrupter-server-error","data-testid":"email-sms-interrupter-server-error-step"},n.createElement("div",{className:"email-sms-interrupter-server-error-message","data-testid":"email-sms-interrupter-server-error-message",dangerouslySetInnerHTML:{__html:a.serverErrorMessage}}),n.createElement("button",{type:"button",className:"button button-lg button-primary button-next email-sms-interrupter-server-error-button","data-testid":"email-sms-interrupter-server-error-button",onClick:function(){window.location.reload()}},a.serverErrorButton))};function h(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var k=function(e){var t,r,a=e.isSubscribed,o=e.showSiteSelectSubCta,u=e.subscribedTitle,m=e.subscribedSubTitle,c=e.sites,d=e.interrupterData,p=e.messages,b=e.cmsMessages,f=e.bannerContainer,v=e.moveCurrentStep,y=e.requestVerificationToken,g=e.isKids,C=e.isCrate,E=e.additionalOptInTitle,k=e.additionalOptInSubTitle,w=e.campaign,T=S((0,n.useState)([]),2),_=T[0],I=T[1];localStorage.setItem("EmailSmsStep","step two");var O=null===(t=window)||void 0===t||null===(t=t.digitalData)||void 0===t||null===(t=t.page)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t.navState,B=null===(r=window)||void 0===r||null===(r=r.digitalData)||void 0===r||null===(r=r.page)||void 0===r||null===(r=r.pageInfo)||void 0===r?void 0:r.brand,N=s.hb.filter((function(e){return e.id===d.interrupterType}))[0],M=s.KB.filter((function(e){return e.name===O&&e.site===B}))[0],x=new l.Z("Communication Preferences Interrupter",N?N.name:"email sms interrupter",M?M.brand:"crate",w,w),D=function(){var e=function(){if(p.otherBrandsBins){for(var e=p.otherBrandsBins.filter((function(e){return e.bin>0})),t=[],r=function(e){var r=c.filter((function(t){return t.brandKey===_[e]}));t.push(r)},n=0;n<_.length;n++)r(n);var a=e.filter((function(e){return t.filter((function(t){return e.name===t[0].brandKeyName.toLowerCase()}))}));return a}}(),t={brands:h(_),bins:e,email:d.email,emailSmsInterrupterType:d.interrupterType,isKids:g};t.brands.length>0&&t.bins&&t.bins.length>0?(0,i.s6)(t,y).then(j).catch((function(e){v("Server Error"),f.classList.add("had-server-error")})):v()},A=function(e){if(13===e.keyCode)return e.preventDefault(),D(),!1},j=function(e){if(e.isSuccess){for(var t,r=[],n=function(e){var n=c.filter((function(t){return t.brandKey===_[e]}))[0].brandKeyName;r.push(n),t=r.join(", ")},a=0;a<_.length;a++)n(a);x.trackEvent("modal","open","additionalsubscriptions",!0,{step:"site select step",sitesSelected:t,brand:M.brand,interrupterType:N}),t&&x.trackPreferencesChange("site select step",M.brand,"success",M.brand,t,e.hashedEmail?e.hashedEmail:""),v("showAdditionalBrandsMsg")}},P=function(e,t){var r=e.target.checked,n=h(_);if(r&&!n.includes(t))n.push(t),I(h(n));else if(!r&&n.includes(t)){var a=n.filter((function(e){return e==t}));I(a)}},L=c.find((function(e){return"core"===e.brandKeyName.toLowerCase()})),F=void 0!==L&&n.createElement(n.Fragment,null,n.createElement("li",{className:"interrupter-select-item"},n.createElement("input",{type:"checkbox",className:"a11y-checkbox crate-and-barrel-checkbox interrupter-select-checkbox",id:"siteSelectCrateAndBarrel",name:"crateAndBarrel",value:"crateAndBarrel","data-testid":"interreupter-cratebarrel-checkbox",onChange:function(e){return P(e,L.brandKey)},onKeyDown:A}),n.createElement("label",{htmlFor:"siteSelectCrateAndBarrel",className:"a11y-checkbox-label crate-and-barrel-label interrupter-brand-label"},n.createElement("img",{className:"interrupter-brand-img",alt:L.brandDescription,src:"".concat(L.brandImageUrl)}),n.createElement("svg",{className:"interrupter-brand-svg svg-icon-logo-cb-small","aria-hidden":"true",focusable:"false"},n.createElement("use",{xlinkHref:"#svg-icon-logo-cb-small"})),n.createElement("span",{className:"sr-only"},"Subscribe to Crate and Barrel"),n.createElement("span",{className:"interrupter-brand-description",dangerouslySetInnerHTML:{__html:L.brandDescription}})))),H=c.find((function(e){return"kids"===e.brandKeyName.toLowerCase()})),K=void 0!==H&&n.createElement(n.Fragment,null,n.createElement("li",{className:"interrupter-select-item"},n.createElement("input",{type:"checkbox",className:"a11y-checkbox crate-and-kids-checkbox interrupter-select-checkbox",id:"siteSelectCrateAndKids",name:"crateAndKids",value:"crateAndKids","data-testid":"interreupter-cratekids-checkbox",onChange:function(e){return P(e,H.brandKey)},onKeyDown:A}),n.createElement("label",{htmlFor:"siteSelectCrateAndKids",className:"a11y-checkbox-label crate-and-kids-label interrupter-brand-label"},n.createElement("img",{className:"interrupter-brand-img",alt:H.brandDescription,src:"".concat(H.brandImageUrl)}),n.createElement("svg",{className:"interrupter-brand-svg svg-icon-logo-crate-and-kids-small","aria-hidden":"true",focusable:"false"},n.createElement("use",{xlinkHref:"#svg-icon-logo-crate-and-kids-small"})),n.createElement("span",{className:"sr-only"},"Subscribe to Crate and Kids"),n.createElement("span",{className:"interrupter-brand-description"},H.brandDescription)))),V=c.find((function(e){return"cb2"===e.brandKeyName.toLowerCase()})),Z=void 0!==V&&n.createElement(n.Fragment,null,n.createElement("li",{className:"interrupter-select-item"},n.createElement("input",{type:"checkbox",className:"a11y-checkbox cb2-checkbox interrupter-select-checkbox",id:"siteSelectCb2",name:"cb2",value:"cb2","data-testid":"interreupter-cb2-checkbox",onChange:function(e){return P(e,V.brandKey)},onKeyDown:A}),n.createElement("label",{htmlFor:"siteSelectCb2",className:"a11y-checkbox-label cb2-label interrupter-brand-label"},n.createElement("img",{className:"interrupter-brand-img",alt:V.brandDescription,src:"".concat(V.brandImageUrl)}),n.createElement("svg",{className:"interrupter-brand-svg svg-icon-logo-cb2","aria-hidden":"true",focusable:"false"},n.createElement("use",{xlinkHref:"#svg-icon-logo-cb2"})),n.createElement("span",{className:"sr-only"},"Subscribe to CB2"),n.createElement("span",{className:"interrupter-brand-description"},V.brandDescription)))),Y=c.find((function(e){return"hg"===e.brandKeyName.toLowerCase()})),q=void 0!==Y&&n.createElement(n.Fragment,null,n.createElement("li",{className:"interrupter-select-item"},n.createElement("input",{type:"checkbox",className:"a11y-checkbox hudson-grace-checkbox interrupter-select-checkbox",id:"siteSelectHudsonGrace",name:"hudsonGrace",value:"hudsonGrace","data-testid":"interreupter-hudsongrace-checkbox",onChange:function(e){return P(e,Y.brandKey)},onKeyDown:A}),n.createElement("label",{htmlFor:"siteSelectHudsonGrace",className:"a11y-checkbox-label hudson-grace-label interrupter-brand-label"},n.createElement("img",{className:"interrupter-brand-img",alt:Y.brandDescription,src:"".concat(Y.brandImageUrl)}),n.createElement("svg",{className:"interrupter-brand-svg svg-icon-logo-hudson-grace","aria-hidden":"true",focusable:"false"},n.createElement("use",{xlinkHref:"#svg-icon-logo-hudson-grace"})),n.createElement("span",{className:"sr-only"},"Subscribe to Hudson and Grace"),n.createElement("span",{className:"interrupter-brand-description"},Y.brandDescription))));return n.createElement("div",{className:"email-sms-interrupter-site-select","data-testid":"email-sms-interrupter-site-select-step"},n.createElement("div",{className:"email-sms-interrupter-site-select-title-row"},a?n.createElement(n.Fragment,null,n.createElement("h2",{className:"email-sms-interrupter-site-select-title","data-testid":"email-sms-interrupter-site-select-title"},n.createElement("div",{dangerouslySetInnerHTML:{__html:u}})),n.createElement("div",{className:"email-sms-interrupter-site-select-form-message","data-testid":"email-sms-interrupter-site-select-form-message",dangerouslySetInnerHTML:{__html:m}})):n.createElement(n.Fragment,null,n.createElement("h2",{className:"email-sms-interrupter-site-select-title","data-testid":"email-sms-interrupter-site-select-title"},d.interrupterType===s.o1.Email?b.smsOnlyTitle:d.interrupterType===s.o1.Sms?b.emailOnlyTitle:E||p.siteSelectTitleCta),o?n.createElement("div",{className:"email-sms-interrupter-site-select-form-message","data-testid":"email-sms-interrupter-site-select-form-message"},d.interrupterType===s.o1.Email?b.checkYourEmailSubTitle:d.interrupterType===s.o1.Sms?b.emailOnlySubTitle:k||p.siteSelectFormMessage):n.createElement(n.Fragment,null))),n.createElement("div",{className:"email-sms-interrupter-site-select-form-row"},n.createElement("h3",{className:"email-sms-interrupter-site-select-sub-cta","data-testid":"email-sms-interrupter-site-select-sub-cta"},p.siteSelectCta),n.createElement("div",{className:"row site-select-container"},n.createElement("ul",{className:"site-select-list"},!C&&F,!C&&K,Z,q)),n.createElement("div",{className:"row"},n.createElement("button",{type:"button",className:"button button-lg button-primary button-next interrupter-site-select-submit-button","data-testid":"email-sms-interrupter-site-select-submit",onClick:D,onKeyDown:A},p.siteSelectButton))))},w=function(e){var t=e.messages,r=e.cmsMessages,a=e.subscribedTitle,i=e.subscribedSubTitle,o=e.moveCurrentStep,s=e.isSubscribed,l=e.additionalOptInTitle,u=e.additionalOptInSubTitle,m=e.showThankYouSubCta,c=e.version;localStorage.setItem("EmailSmsStep","step three");return n.createElement("div",{className:"email-sms-interrupter-thank-you ".concat("v1"===c?"email-sms-interrupter-thank-you-v1":""),"data-testid":"email-sms-interrupter-thank-you-step"},n.createElement("h2",{className:"email-sms-interrupter-thank-you-title","data-testid":"email-sms-interrupter-thank-you-title"},m?r.notSubscribedAllBrandsThankYouStepTitle:s?a:m?l||void 0:r.subscribedAllBrandsThankYouStepTitle),s&&n.createElement("div",{className:"email-sms-interrupter-subscribed-sub-title",dangerouslySetInnerHTML:{__html:u||i}}),m&&n.createElement("div",{className:"email-sms-interrupter-thank-you-message","data-testid":"email-sms-interrupter-thank-you-message"},u||t.thankYouMessage),n.createElement("button",{type:"button",className:"button button-lg button-primary button-next email-sms-interrupter-thank-you-button","data-testid":"email-sms-interrupter-thank-you-button",onClick:o},t.thankYouButton))},T=r(55763);function _(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N=function(e){var t=e.interrupterData,r=e.messages,o=e.bannerContainer,l=e.version,u=e.isCanada,m=e.closeCallback,c=e.logActionCallback,d=e.closeInterrupter,p=e.suppressInterrupter,b=a.Z.get("NewV1InterrupterStep"),f=function(){a.Z.deleteCookie("InterrupterAlreadySubscribedEmail"),a.Z.deleteCookie("NewV1InterrupterKidsOptIn"),a.Z.deleteCookie("NewV1InterrupterStep"),a.Z.deleteCookie("NewV1InterrupterEmail")},v=I((0,n.useState)((0,T.tq)()&&l&&"v1"===l?t.interrupterType===s.o1.Combo?b&&"new v1 step two"===b?s.uH.NewV1StepTwo:s.uH.NewV1StepOne:t.interrupterType===s.o1.Email?s.uH.NewV1StepOne:s.uH.NewV1StepTwo:s.uH.FormEntry),2),h=v[0],S=v[1],C=I((0,n.useState)([]),2),E=C[0],O=C[1],B=I((0,n.useState)(!1),2),N=B[0],M=B[1],x=I((0,n.useState)(!1),2),D=x[0],A=x[1],j=I((0,n.useState)(!1),2),P=j[0],L=j[1],F=I((0,n.useState)(),2),H=F[0],K=F[1],V=I((0,n.useState)(),2),Z=V[0],Y=V[1],q=I((0,n.useState)(),2),R=q[0],U=q[1],$=I((0,n.useState)(),2),G=$[0],z=$[1],Q=I((0,n.useState)(),2),J=Q[0],W=Q[1],X=I((0,n.useState)(),2),ee=X[0],te=X[1],re=function(){var e,t=null===(e=window)||void 0===e||null===(e=e.digitalData)||void 0===e||null===(e=e.page)||void 0===e||null===(e=e.attributes)||void 0===e?void 0:e.navState,r=!1;return t&&(r="cratekids"===t.toLocaleLowerCase()),r},ne=function(){return t.interrupterType!==s.o1.Sms||void 0===r.smsBannerCta||re()?t.interrupterType!==s.o1.Email||void 0===r.emailBannerCta||re()?r.desktopBannerCta:r.emailBannerCta:r.smsBannerCta},ae=function(e,n,o,l){if(l&&(K(l),Y(l.comboTitle),U(l.comboSubTitle)),h===s.uH.FormEntry){if("Server Error"===e)return S(s.uH.Error),localStorage.setItem("interrupterHadServerError","added"),void a.Z.deleteCookie("EmailOptInAlreadyViewedCount");t.interrupterType===s.o1.Sms&&(A(!0),z(l.emailOnlySubTitle),W(l.emailOnlySubTitle),S(s.uH.ThankYou)),n&&(0,i.EY)(n,re()).then((function(n){var a=_(n.brands);O(a),te(n.isCrate),t.interrupterType===s.o1.Email&&((e.subscribedEmail||"both"===e.status)&&(M(!0),0<a.length?S(s.uH.SiteSelect):S(s.uH.ThankYou)),(null==e||"none"===e.status||e.subscribedSms)&&(0<a.length?(L(!0),S(s.uH.SiteSelect)):(A(!0),z(l.checkYourEmailSubTitle),W(l.smsOnlyTitle),S(s.uH.ThankYou)))),t.interrupterType===s.o1.Combo&&(e.subscribedEmail&&e.subscribedSms&&(M(!0),o&&(Y(r.siteSelectTitleCta),U(l.checkYourEmailSubTitle)),0===a.length?S(s.uH.ThankYou):S(s.uH.SiteSelect)),!e.subscribedEmail&&e.subscribedSms&&(M(!0),Y(l.smsOnlyTitle),U(o?l.checkYourEmailSubTitle:l.smsOnlySubTitle),0===a.length?S(s.uH.ThankYou):S(s.uH.SiteSelect)),e.subscribedEmail&&!e.subscribedSms&&(M(!0),Y(o?r.siteSelectTitleCta:l.emailOnlyTitle),U(o?l.crateUsSuccessMessageWithKids:l.emailOnlySubTitle),0<a.length?S(s.uH.SiteSelect):S(s.uH.ThankYou)),null!=e&&"none"!==e.status||(o&&(A(!0),z(l.crateUsSuccessMessageWithKids),W(r.siteSelectTitleCta)),0<a.length?(L(!0),S(s.uH.SiteSelect)):S(s.uH.ThankYou)))}))}h===s.uH.SiteSelect&&(f(),M(!1),z(null),W(null),"Server Error"===e&&(S(s.uH.Error),localStorage.setItem("interrupterHadServerError","added"),a.Z.deleteCookie("EmailOptInAlreadyViewedCount")),e===s.Uf.ShowAdditionalBrandsMsg&&A(!0),S(s.uH.ThankYou)),h===s.uH.ThankYou&&(f(),m("step three","start shopping"))},ie=n.createElement(n.Fragment,null);switch(h){case s.uH.FormEntry:ie=n.createElement(y,{interrupterData:t,messages:r,isMobile:(0,T.tq)(),version:l,moveCurrentStep:ae,bannerContainer:o,closeInterrupter:d,suppressInterrupter:p,isKids:re(),isCanada:u,campaign:ne()});break;case s.uH.SiteSelect:ie=n.createElement(k,{sites:E,interrupterData:t,messages:r,cmsMessages:H,bannerContainer:o,moveCurrentStep:ae,isSubscribed:N,subscribedTitle:Z,subscribedSubTitle:R,showSiteSelectSubCta:P,additionalOptInSubTitle:G,additionalOptInTitle:J,isKids:re(),isCrate:ee,version:l,campaign:ne()});break;case s.uH.Error:!function(e,t,r){c&&c(e,t,r,arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null)}("modal","open","error",!0,t),ie=n.createElement(g,{messages:r,interrupterData:t,campaign:ne()});break;case s.uH.ThankYou:ie=n.createElement(w,{interrupterData:t,messages:r,cmsMessages:H,subscribedTitle:Z,subscribedSubTitle:R,moveCurrentStep:ae,isSubscribed:N,showThankYouSubCta:D,additionalOptInSubTitle:G,additionalOptInTitle:J,version:l,campaign:ne()})}return(0,T.tq)()?n.createElement("div",{id:"MobileInterrupterContainer",className:"mobile-email-sms-interrupter-container","data-testid":"mobile-email-sms-interrupter-container"},n.createElement("div",{className:"mobile-interrupter-body"},ie)):n.createElement("div",{id:"InterrupterContainer",className:"email-sms-interrupter-container","data-testid":"email-sms-interrupter-container"},n.createElement("div",{className:"interrupter-body"},ie))},M=function(e){var t=e.interrupterData,r=e.messages,a=e.cmsMessages,i=e.isCanada,o=e.bannerContainer,s=e.version,l=e.closeCallback,u=e.logActionCallback,m=e.closeInterrupter,c=e.suppressInterrupter,d=n.createElement(N,{interrupterData:t,messages:r,cmsMessages:a,bannerContainer:o,version:s,isCanada:i,closeCallback:l,logActionCallback:u,closeInterrupter:m,suppressInterrupter:c});return n.createElement("div",{className:"email-sms-interrupter","data-testid":"email-sms-interrupter"},d)}},97357:function(e,t,r){r.d(t,{KB:function(){return o},Uf:function(){return s},hb:function(){return i},o1:function(){return a},uH:function(){return n}});var n={FormEntry:"FormEntry",SiteSelect:"SiteSelect",NewV1StepOne:"NewV1StepOne",NewV1StepTwo:"NewV1StepTwo",ThankYou:"ThankYou",Error:"Error"},a={None:0,Combo:1,Email:2,Sms:3},i=[{id:0,name:"no interrupter"},{id:1,name:"email sms interrupter"},{id:2,name:"email interrupter"},{id:3,name:"sms interrupter"}],o=[{name:"default",site:"crate and barrel",brand:"crate"},{name:"cratekids",site:"crate and barrel",brand:"kids"},{name:"default",site:"cb2",brand:"cb2"},{name:"default",site:"crate and barrel canada",brand:"crate"},{name:"default",site:"cb2 canada",brand:"cb2"}],s={ShowAdditionalBrandsMsg:"showAdditionalBrandsMsg"}},22824:function(e,t,r){r.d(t,{M:function(){return a},H:function(){return i}});var n={Email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,DomesticPhone:/^(?:[\+\s]?1[-.\s]?)?\(?([2-9]{1}\d{2})\)?[-.]?\s?(\d{3})[-.]?\s?(\d{4})$/},a=function(e){return n.DomesticPhone.test(e)},i=function(e){return n.Email.test(e)}},44683:function(e,t,r){r.d(t,{g:function(){return n}});var n={ReminderThresholdInPageViews:99,EmailQueryStringParameter:"e",SessionStorage:{EmailSmsInterrupter:"EmailSmsInterrupter"},Classes:{Expanded:"expanded"},Cookies:{OptIn:"EmailOptIn",OptOut:"EmailOptInSuppressed",AlreadyViewedCount:"EmailOptInAlreadyViewedCount",IsLoggedIn:"Account",HideProgramInterrupter:"HideProgramInterrupterTillNextSession"}}},55763:function(e,t,r){r.d(t,{S5:function(){return a},b1:function(){return o},eQ:function(){return i},tq:function(){return n}});var n=function(){var e=document.getElementById("jsIsMobile");return!!e&&"1"===e.value},a="undefined"!=typeof File,i=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){return e=!0}}),r=function(){};window.addEventListener("test",r,t),window.removeEventListener("test",r,t)}catch(t){e=!1}return e},o="undefined"!=typeof window&&"undefined"!=typeof navigator&&("ontouchstart"in window||navigator.maxTouchPoints>0)},83999:function(e,t,r){r.d(t,{Z:function(){return p}});var n=r(95792);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===a(t)?t:String(t)}var c={eventInfo:{eventName:"Interrupter",eventAction:"",eventPoints:0,type:"track",timeStamp:null,effect:""},category:{primaryCategory:"Page Events"},attributes:{audience:"core",campaign:""}},d={eventInfo:{eventName:"Preferences Changed",type:"track",timeStamp:null},category:{primaryCategory:"user"},attributes:{audience:"core"}},p=l((function e(t,r){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"trackEvent",(function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,m=o(o({},a.eventData),{},{eventInfo:o(o({},a.eventData.eventInfo),{},{eventAction:r,timeStamp:new Date}),attributes:o(o({},a.eventData.attributes),{},{source:e.toLowerCase(),status:t.toLowerCase()}),data:s});i&&(m=o(o({},m),{},{attributes:o(o({},m.attributes),{},{isAutoTriggered:i})})),null!==l&&(m=o(o({},m),{},{attributes:o(o({},m.attributes),{},{sha256_hashed_contact:l})})),null!==u&&(m=o(o({},m),{},{attributes:o(o({},m.attributes),{},{isAlreadySubscribed:u})})),n.Z.track(m)})),u(this,"trackPreferencesChange",(function(e,t,r,a,i,s,l){var u=o(o({},d),{},{eventInfo:o(o({},d.eventInfo),{},{eventName:"Preferences Changed"}),attributes:o(o({},d.attributes),{},{type:"optin",name:"setpreference",primaryCategory:t.toLowerCase(),audience:a.toLowerCase(),source:e.toLowerCase(),status:r.toLowerCase(),contact_type:"email",sha256_hashed_contact:(null==s?void 0:s.toLowerCase())||l,preferences_changed:i})});n.Z.track(u)})),this.eventData=o(o({},c),{},{eventInfo:o(o({},c.eventInfo),{},{eventName:t}),category:o(o({},c.category),{},{primaryCategory:null!=s?s:c.category.primaryCategory}),attributes:o(o({},c.attributes),{},{type:r,audience:null!=i?i:c.attributes.audience,campaign:null!=l?l:c.attributes.campaign})})}))},35749:function(e,t,r){var n=r(35466),a=r(46116),i=r(55763),o=r(88390),s=r(29728),l=r(70554),u=r(83329),m=r(97357),c=function(e){var t,r=e.interrupterData,a=e.messages,i=e.isKids,o=e.isMobile;return n.createElement("span",{id:"email-sms-banner-text-message-content"},(t=o?a.mobileBannerCta:a.desktopBannerCta,(null==r?void 0:r.interrupterType)!==m.o1.Sms||void 0===a.smsBannerCta||i?(null==r?void 0:r.interrupterType)!==m.o1.Email||void 0===a.emailBannerCta||i||(t=a.emailBannerCta):t=a.smsBannerCta,t))},d=r(83999),p=r(87486),b=r(22824);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C=function(e){var t,r,a,i=e.interrupterData,o=e.messages,s=e.isCanada,l=e.isKids,u=e.expandBanner,c=e.version,f=e.moveCurrentStep,v=e.bannerContainer,g=e.suppressInterrupter,S=e.campaign;localStorage.setItem("EmailSmsStep","v1"===c?"new v1 step one":"medium banner step"),document.cookie="NewV1InterrupterStep=".concat("v1"===c&&"new v1 step one");var C,E=null===(t=window)||void 0===t||null===(t=t.digitalData)||void 0===t||null===(t=t.page)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t.navState,k=null===(r=window)||void 0===r||null===(r=r.digitalData)||void 0===r||null===(r=r.page)||void 0===r||null===(r=r.pageInfo)||void 0===r?void 0:r.brand,w=m.hb.filter((function(e){return e.id===i.interrupterType}))[0],T=m.KB.filter((function(e){return e.name===E&&e.site===k}))[0],_=h((0,n.useState)(null!==(a=i.email)&&void 0!==a?a:""),2),I=_[0],O=_[1],B=h((0,n.useState)(!s&&!l&&o.showKidsCheckbox),2),N=B[0],M=B[1],x=h((0,n.useState)({email:!1}),2),D=x[0],A=x[1],j=new d.Z("Communication Preferences Interrupter",w?w.name:"email sms interrupter",T?T.brand:"crate",S,S),P=function(){var e=document.querySelector("#email");e&&e.focus()},L=function(){if(function(){var e;e=(0,b.H)(I);var t=y({},D);return t.email=!e,A(y({},t),P()),e}())if(s||i.interrupterType===m.o1.Email){var e=l?o.kidsCreativeId:o.creativeId;(0,p.C3)({creativeId:e,email:I,cellPhone:"",emailSmsInterrupterType:i.interrupterType,bin:o.bin,isKidsPage:l,isAdditionalOptIn:N}).then(F).catch((function(e){f("Server Error"),v.classList.add("had-server-error")}))}else document.cookie="NewV1InterrupterEmail=".concat(I),document.cookie="NewV1InterrupterKidsOptIn=".concat(N),f({status:"none",subscribedSms:!1,subscribedEmail:!1},I)},F=function(e){if(e.isSuccess){i.interrupterType!==m.o1.Combo&&g(),i.email=I,document.cookie="NewV1InterrupterEmail=".concat(I),document.cookie="NewV1InterrupterKidsOptIn=".concat(N);var t=function(){var t={status:e.subscriptionStatus};return e.isAlreadySubscribedSms&&(t.subscribedSms=!0),e.isAlreadySubscribedEmail&&(t.subscribedEmail=!0),t};""===I?(0,p.Fr)().then((function(e){null!==e.email&&f(t(),e.email)})):f(t(),I),e.isAlreadySubscribedEmail?j.trackEvent("modal","open","subscribed",!1,{step:"step one",email:!0,phone:!1,brand:"".concat(T.brand," ").concat(N?"and ".concat(T.brand,"kids"):""),interrupterType:w},e.hashedEmail?e.hashedEmail:"",!0):(j.trackEvent("modal","open","subscribed",!1,{step:"step one",email:!0,phone:!1,brand:"".concat(T.brand," ").concat(N?"and ".concat(T.brand,"kids"):""),interrupterType:w},e.hashedEmail?e.hashedEmail:"",!1),j.trackPreferencesChange("mobile step one",T.brand,"success",T.brand,"".concat(T.brand," ").concat(N?"and ".concat(T.brand,"kids"):""),e.hashedEmail?e.hashedEmail:""))}else f("Server Error"),v.classList.add("had-server-error")},H=n.createElement("div",{className:"email-sms-invalid-input-error"},n.createElement("svg",{className:"icon svg-icon-error",role:"img","aria-label":"Error"},n.createElement("use",{xlinkHref:"#svg-icon-error"})),n.createElement("span",null,"Oops! Enter a valid email address.")),K=n.createElement("div",{className:"row email-sms-interrupter-field-row"},n.createElement("label",{htmlFor:"email"},"Email Address",n.createElement("span",{className:"required"},"required")),n.createElement("input",{"aria-describedby":"emailError",id:"email",maxLength:"80",name:"email",type:"text",className:"input-lg interrupter-field ".concat(D.email?"input-validation-error interrupter-field-error":"input-validation-valid"),"data-testid":"email-sms-interrupter-email-field",onChange:function(e){var t=e.target.value;O(t);var r=y({},D);r.email=!1,A(y({},r),P())},value:I,onKeyDown:function(e){if(13===e.keyCode)return e.preventDefault(),L(),!1}})),V=n.createElement("div",{className:"row email-sms-interrupter-field-row kids-interrupter-checkbox-row"},n.createElement("input",{type:"checkbox",className:"email-sms-kids-checkbox a11y-checkbox","data-testid":"email-sms-interrupter-email-kids-field",id:"emailKidsOptIn",name:"emailKidsOptIn",defaultChecked:N,onChange:function(e){var t=e.target.checked;M(t)}}),n.createElement("label",{className:"a11y-checkbox-label",htmlFor:"emailKidsOptIn"},o.kidsCheckboxLabelMessage)),Z=n.createElement("button",{type:"button","data-role":"none",className:"email-sms-interrupter-arrow-button button button-primary","aria-label":"Submit form",onClick:L},n.createElement("svg",{className:"svg-icon-arrow-primary-right","aria-hidden":"true",focusable:"false"},n.createElement("use",{xlinkHref:"#svg-icon-arrow-primary-right"})),n.createElement("span",{className:"sr-only"},"Submit Form"));return n.createElement("div",{id:"email-sms-mobile-medium-banner-content",className:"email-sms-mobile-medium-banner-content ".concat("v1"===c?"email-sms-mobile-medium-banner-content-v1":""),"data-testid":"email-sms-mobile-medium-banner-content"},n.createElement("div",{className:"email-sms-mobile-medium-banner-title","data-testid":"email-sms-mobile-medium-banner-title"},(C=o.mobileMediumBannerCta,i.interrupterType===m.o1.Sms&&o.mobileBannerSmsOnlyCta&&!l?C=o.mobileBannerSmsOnlyCta:i.interrupterType===m.o1.Email&&o.mobileBannerEmailOnlyCta&&!l&&(C=o.mobileBannerEmailOnlyCta),C)),n.createElement("div",{className:"email-sms-mobile-medium-banner-text","data-testid":"email-sms-mobile-medium-banner-text"},function(){var e=o.mobileBannerSubCta;return i.interrupterType===m.o1.Sms&&o.mobileBannerSmsOnlySubCta&&!l?e=o.mobileBannerSmsOnlySubCta:i.interrupterType===m.o1.Email&&o.mobileBannerEmailOnlySubCta&&!l&&(e=o.mobileBannerEmailOnlySubCta),e}()),"v1"!==c&&n.createElement("button",{type:"button",className:"button button-lg button-primary button-next email-sms-mobile-medium-banner-button","data-testid":"email-sms-mobile-medium-banner-button",onClick:function(){j.trackEvent("banner","expand","clicked",{step:"step one"}),u&&u()}},function(){var e=o.mobileBannerCtaButton;return i.interrupterType===m.o1.Sms&&o.mobileBannerSmsOnlyCtaButton&&!l?e=o.mobileBannerSmsOnlyCtaButton:i.interrupterType===m.o1.Email&&o.mobileBannerEmailOnlyCtaButton&&!l&&(e=o.mobileBannerEmailOnlyCtaButton),e}()),"v1"===c&&n.createElement("form",null,n.createElement("div",{className:"email-sms-interrupter-email-only-form email-sms-interrupter-form"},n.createElement("div",{className:"email-sms-interrupter-form-fields-group"},n.createElement("div",{className:"email-sms-interrupter-v1-fields"},K,Z),n.createElement("div",{id:"emailError",className:"field-validation-error ".concat(D.email?"":"hidden"),"data-testid":"email-sms-interrupter-email-error"},D.email&&H),i.interrupterType===m.o1.Combo&&n.createElement("p",{className:"email-sms-interrupter-v1-step-info"},"Step 1 of 2 to claim offer"),o.showKidsCheckbox&&!i.isCb2&&!l&&V,n.createElement("div",{className:"email-sms-interrupter-form-footer-row"},n.createElement("div",{className:"email-sms-interrupter-form-footer","data-testid":"email-sms-interrupter-form-footer-email",dangerouslySetInnerHTML:{__html:o.formEmailTc}}))))))},E=r(44683);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function T(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e){var t=function(e,t){if("object"!==k(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===k(t)?t:String(t)}var O=T((function e(){var t,r,b,f,v=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_(this,"setInterrupterVersion",(function(e){return v._interrupterVersion=e,v})),_(this,"setBanner",(function(e){return v._bannerContainer=e,v})),_(this,"setModal",(function(e){return v._modalContainer=e,v})),_(this,"setMobileDrawerFormContainer",(function(e){return v._mobileDrawerFormContainer=e,v})),_(this,"getInterrupterType",(function(){return(0,p.Fr)().then((function(e){if(e)return e.interrupterType}))})),_(this,"shouldInterrupterDisplay",(function(){return(0,p.Fr)().then((function(e){v._cmsMessages=e.messages,localStorage.removeItem("EmailSmsStep");var t=sessionStorage.getItem(E.g.SessionStorage.EmailSmsInterrupter);if(v._isSuppressed)return new Promise((function(e){e(!1)}));if(v._isInterrupterAlreadyViewed())return new Promise((function(e){e(!1)}));if(v._isEmailClickThrough())return new Promise((function(e){e(!1)}));if(t){var r=JSON.parse(t);if(v._isKids&&r.kidsInterrupterType===m.o1.None)return new Promise((function(e){e(!1)}));if(r.interrupterType===m.o1.None)return new Promise((function(e){e(!1)}));v._interrupterData=r;var n=m.hb.filter((function(e){return e.id===r.interrupterType}))[0],a=m.KB.filter((function(e){return e.name===brand&&e.site===site}))[0],i=v.setcampaign(r,v._messagesObject);return v._ddlService=new d.Z("Communication Preferences Interrupter",n?n.name:"email sms interrupter",a?a.brand:"crate",i,i),new Promise((function(e){e(!0)}))}if(!v._isLoggedIn())return v._setDefaultInterrupter(),new Promise((function(e){e(!0)}));if(!e)return v._setDefaultInterrupter(),!0;if("combo"!==v._messagesObject.interrupterOverrideType&&(e=v._getOverrideInterrupter(e)),e.interrupterType===m.o1.None)return!1;v._interrupterData=e,sessionStorage.setItem(E.g.SessionStorage.EmailSmsInterrupter,JSON.stringify(e));var o=m.hb.filter((function(t){return t.id===e.interrupterType}))[0],s=m.KB.filter((function(e){return e.name===brand&&e.site===site}))[0],l=v.setcampaign(e,v._messagesObject);return v._ddlService=new d.Z("Communication Preferences Interrupter",o?o.name:"email sms interrupter",s?s.brand:"crate",l,l),!0})).catch((function(){return!1}))})),_(this,"setcampaign",(function(e,t){return e.interrupterType!==m.o1.Sms||void 0===t.smsBannerCta||v._isKids?e.interrupterType!==m.o1.Email||void 0===t.emailBannerCta||v._isKids?t.desktopBannerCta:t.emailBannerCta:t.smsBannerCta})),_(this,"setMessages",(function(e,t,r,n,a,i){return v._messagesObject={mobileBannerCta:e.mobileBannerCta,mobileMediumBannerCta:e.mobileMediumBannerCta,mobileBannerSubCta:e.mobileBannerSubCta,mobileBannerCtaButton:e.mobileBannerCtaButton,mobileV1Step2SubCta:e.mobileV1Step2SubCta,mobileBannerSmsOnlyCta:e.mobileBannerSmsOnlyCta,mobileBannerSmsOnlySubCta:e.mobileBannerSmsOnlySubCta,mobileBannerSmsOnlyCtaButton:e.mobileBannerSmsOnlyCtaButton,mobileBannerEmailOnlyCta:e.mobileBannerEmailOnlyCta,mobileBannerEmailOnlySubCta:e.mobileBannerEmailOnlySubCta,mobileBannerEmailOnlyCtaButton:e.mobileBannerEmailOnlyCtaButton,desktopBannerCta:e.desktopBannerCta,smsBannerCta:e.smsBannerCta,emailBannerCta:e.emailBannerCta,titleCta:t.formTitleCta,smsTitleCta:t.smsFormTitleCta,emailTitleCta:t.emailFormTitleCta,formTc:t.termsAndConditions,kidsFormTc:t.kidsTermsAndConditions,kidsFormEmailTc:t.kidsEmailTermsAndConditions,kidsFormSmsTc:t.kidsSmsTermsAndConditions,formSmsTc:t.smsTermsAndConditions,formEmailTc:t.emailTermsAndConditions,formComboTypeCta:t.formComboTypeSecondaryCta,formEmailTypeCta:t.formEmailTypeSecondaryCta,formSMSTypeCta:t.formSMSTypeSecondaryCta,formButton:t.formButton,mobileSmsButton:t.mobileSmsButton,serverErrorMessage:n.serverErrorCta,serverErrorButton:n.serverErrorButton,thankYouCta:a.thankYouCta,alreadySubscribedThankYouCta:a.alreadySubscribedThankYouCta,thankYouButton:a.thankYouButton,thankYouMessage:a.thankYouMessage,siteSelectTitleCta:r.siteSelectTitleCta,siteSelectFormMessage:r.siteSelectFormMessage,siteSelectCta:r.siteSelectCta,siteSelectButton:r.siteSelectButton,smsTextMessage:t.smsTextMessage,kidsSmsTextMessage:t.kidsSmsTextMessage,kidsCheckboxLabelMessage:t.kidsCheckboxLabelMessage,crateCheckboxLabelMessage:t.crateCheckboxLabelMessage,bin:i.bin,otherBrandsBins:i.otherBrandsBins,creativeId:i.creativeId,kidsCreativeId:i.kidsCreativeId,shortCode:i.shortCode,kidsShortCode:i.kidsShortCode,showKidsCheckbox:"1"===i.showKidsCheckbox,interrupterOverrideType:i.interrupterType},v})),_(this,"openModal",(function(e){localStorage.removeItem("EmailSmsStep");var t=v._removeModalHtml();return l.x0({innerHTML:t,closeCallback:v.closeModal,minimizeCallback:v.collapseModal,containerClasses:["email-sms-interrupter-popup"]},!0),v._setReactModalComponent(),v._ddlService.trackEvent("modal","open","open modal","clicked"!==e,{step:"step one"}),v})),_(this,"closeModal",(function(e,t){(0,i.tq)()?v._removeReactMobileDrawerFormComponent():v._removeReactModalComponent();var r=localStorage.getItem("EmailSmsStep"),n=e||r,a=t||"close";return v._ddlService.trackEvent("modal","closed","close modal",!1,{step:n,exitType:a}),e===m.uH.ThankYou?(v._setSignupCookie(0,0,60),v._updateViewedStatus()):v._isOldInterrupter?v._updateViewedStatus():localStorage.setItem("EmailSmsMovedToBanner",1),v._isInterrupterAlreadyViewed()||v._isOldInterrupter||v.openBanner(),l._8(!1),v})),_(this,"openBanner",(function(){v._bannerContainer.classList.remove("hidden"),"added"===v._hadServerError&&((0,i.tq)()?v._mobileDrawerFormContainer.classList.remove("hidden"):(v._bannerContainer.classList.add("hidden"),v.openModal())),localStorage.removeItem("interrupterHadServerError");var e=document.getElementById("email-sms-banner-text-message-content"),t=localStorage.getItem("EmailSmsMovedToBanner");null===e&&(!v._isOldInterrupter&&(0,i.tq)()&&null===t&&"v2"===v._interrupterVersion?(v._setReactMobileMediumBanner(),v._isBannerExpanded=!0):!v._isOldInterrupter&&(0,i.tq)()&&null===t&&"v1"===v._interrupterVersion?(v._setReactMobileDrawerFormComponent(v._interrupterVersion),v._setReactBannerText(),v._isBannerExpanded=!0,v._mobileDrawerFormContainer.classList.remove("hidden"),v._bannerContainer.classList.remove("hidden")):(v._setReactBannerText(),document.querySelector("#signup-message-toggle").classList.add("show-new-email-sms-signup-button"))),v._ddlService.trackEvent("banner","open","clicked")})),_(this,"closeBanner",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return v._bannerContainer.classList.add("hidden"),v._removeReactBannerText(),(0,i.tq)()&&(v._removeReactMobileDrawerFormComponent(),v._mobileOverlayClick&&v._mobileOverlayClick.removeEventListener("click",v._handleOverlayClick)),!v._isBannerExpanded&&e&&(v._updateViewedStatus(),o.Z.setCookie(E.g.Cookies.HideProgramInterrupter,!0),v._ddlService.trackEvent("banner","closed","close banner")),v._isBannerExpanded&&(v._isOldInterrupter?(v._updateViewedStatus(),o.Z.setCookie(E.g.Cookies.HideProgramInterrupter,!0),v._ddlService.trackEvent("banner","closed","close banner")):localStorage.setItem("EmailSmsMovedToBanner",1)),v})),_(this,"toggleBanner",(function(){return v._isBannerExpanded?v._collapseBanner():v._expandBanner(),(0,i.tq)()&&v._bannerContainer.setAttribute("aria-expanded","true"!=v._bannerContainer.getAttribute("aria-expanded")),v})),_(this,"onLogAction",(function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;v._ddlService.trackEvent(e,t,r,n,a)})),_(this,"_setDefaultInterrupter",(function(){var e,t,r=null===(e=window)||void 0===e||null===(e=e.digitalData)||void 0===e||null===(e=e.page)||void 0===e||null===(e=e.attributes)||void 0===e?void 0:e.navState,n=m.o1.Combo,a=m.hb.filter((function(e){return e.id===n}))[0],i=m.KB.filter((function(e){return e.name===r&&e.site===brand}))[0];if(v._ddlService=new d.Z("Communication Preferences Interrupter",a?a.name:"email sms interrupter",i?i.brand:"crate",v._messagesObject.desktopBannerCta,v._messagesObject.desktopBannerCta),v._messagesObject&&v._messagesObject.interrupterOverrideType){if("sms"===v._messagesObject.interrupterOverrideType)return void(v._interrupterData={interrupterType:m.o1.Sms,kidsInterrupterType:m.o1.Sms,isCb2:v._isCb2});if("email"===v._messagesObject.interrupterOverrideType)return void(v._interrupterData={interrupterType:m.o1.Email,kidsInterrupterType:m.o1.Email,isCb2:v._isCb2})}v._interrupterData={interrupterType:m.o1.Combo,kidsInterrupterType:m.o1.Combo,isCb2:"cb2"===(null===(t=window)||void 0===t||null===(t=t.digitalData)||void 0===t||null===(t=t.page)||void 0===t||null===(t=t.pageInfo)||void 0===t?void 0:t.brand)}})),_(this,"_getOverrideInterrupter",(function(e){if(v._messagesObject&&v._messagesObject.interrupterOverrideType)return"sms"===v._messagesObject.interrupterOverrideType?{interrupterType:e.interrupterType===m.o1.Email||e.interrupterType===m.o1.None?m.o1.None:m.o1.Sms,kidsInterrupterType:e.kidsInterrupterType===m.o1.Email||e.kidsInterrupterType===m.o1.None?m.o1.None:m.o1.Sms,isCb2:v._isCb2}:"email"===v._messagesObject.interrupterOverrideType?{interrupterType:e.interrupterType===m.o1.Sms||e.interrupterType===m.o1.None?m.o1.None:m.o1.Email,kidsInterrupterType:e.kidsInterrupterType===m.o1.Sms||e.kidsInterrupterType===m.o1.None?m.o1.None:m.o1.Email,isCb2:v._isCb2}:e})),_(this,"_isEmailClickThrough",(function(){return!!s.Z.getValue(E.g.EmailQueryStringParameter)&&(v._setSignupCookie(0,0,14),!0)})),_(this,"_isInterrupterAlreadyViewed",(function(){if(o.Z.get(E.g.Cookies.OptIn))return!0;var e=o.Z.get(E.g.Cookies.AlreadyViewedCount);return!!(e&&e<E.g.ReminderThresholdInPageViews)&&(v._updateViewedStatus(),!0)})),_(this,"_isLoggedIn",(function(){var e=o.Z.get(E.g.Cookies.IsLoggedIn);return e||!1})),_(this,"_updateViewedStatus",(function(){var e=o.Z.get(E.g.Cookies.AlreadyViewedCount);e=e?parseInt(e)>=E.g.ReminderThresholdInPageViews?1:parseInt(e)+1:1,o.Z.setCookie(E.g.Cookies.AlreadyViewedCount,e)})),_(this,"_setReactBannerText",(function(){v._bannerTextContainer=document.querySelector("#signup-message-toggle");var e=v._updateDataForDisplay();a.render(n.createElement(c,{interrupterData:e,messages:v._messagesObject,cmsMessages:v._cmsMessages,isCb2:v._isCb2,isKids:v._isKids,isMobile:(0,i.tq)()}),v._bannerTextContainer)})),_(this,"_setReactMobileMediumBanner",(function(e){v._mobileMediumBannerContainer=document.querySelector("#email-sms-interrupter-mobile-medium-banner");var t=v._updateDataForDisplay();a.render(n.createElement(C,{interrupterData:t,messages:v._messagesObject,cmsMessages:v._cmsMessages,isCb2:v._isCb2,isKids:v._isKids,isMobile:(0,i.tq)(),version:e,isCanada:v._isCanadaSite,expandBanner:v._expandBanner}),v._mobileMediumBannerContainer)})),_(this,"_removeReactBannerText",(function(){var e=document.getElementById("email-sms-banner-text-message-content");e&&e.length>0&&a.unmountComponentAtNode(v._bannerTextContainer)})),_(this,"_removeReactMobileMediumBanner",(function(){document.querySelector("#email-sms-mobile-medium-banner-content");a.unmountComponentAtNode(v._mobileMediumBannerContainer)})),_(this,"_setReactModalComponent",(function(){v._modalEmailForm=document.querySelector("#email-sms-interrupter-component");var e=v._updateDataForDisplay();a.render(n.createElement(u.g,{interrupterData:e,messages:v._messagesObject,cmsMessages:v._cmsMessages,isCb2:v._isCb2,bannerContainer:v._bannerContainer,closeCallback:v.closeModal,logActionCallback:v.onLogAction,closeInterrupter:v.closeModal,suppressInterrupter:v._updateViewedStatus,isCanada:v._isCanadaSite}),v._modalEmailForm)})),_(this,"_setReactMobileDrawerFormComponent",(function(e){v._mobileDrawerForm=document.querySelector("#mobile-email-sms-interrupter-component");var t=v._updateDataForDisplay();a.render(n.createElement(u.g,{interrupterData:t,messages:v._messagesObject,cmsMessages:v._cmsMessages,isCb2:v._isCb2,bannerContainer:v._bannerContainer,version:e,isCanada:v._isCanadaSite,closeCallback:v.closeModal,logActionCallback:v.onLogAction,closeInterrupter:v._collapseBanner,suppressInterrupter:v._updateViewedStatus}),v._mobileDrawerForm)})),_(this,"_updateDataForDisplay",(function(){var e=v._interrupterData;return v._isKids&&(e.interrupterType=e.kidsInterrupterType),e})),_(this,"_removeReactModalComponent",(function(){v._modalContainer.innerHTML=v._tempModalHtml,v._tempModalHtml=null,v._modalEmailForm&&a.unmountComponentAtNode(v._modalEmailForm),v._modalContainer.classList.remove("had-server-error"),v._isOldInterrupter&&v._bannerContainer.classList.add("hidden")})),_(this,"_removeReactMobileDrawerFormComponent",(function(){null!==v._mobileDrawerForm&&(a.unmountComponentAtNode(v._mobileDrawerForm),v._bannerContainer.classList.remove("had-server-error"),v._bannerContainer.classList.add("hidden"))})),_(this,"_removeModalHtml",(function(){var e=v._modalContainer.innerHTML;return v._tempModalHtml=e,v._modalContainer.innerHTML="",e})),_(this,"_collapseBanner",(function(e,t){v._isBannerExpanded=!1,v._bannerContainer.classList.remove(E.g.Classes.Expanded);var r=localStorage.getItem("EmailSmsMovedToBanner");(0,i.tq)()?(document.querySelector("#signup-message-toggle").disabled=!1,v._isOldInterrupter&&v._removeReactMobileDrawerFormComponent(),v._mobileDrawerFormContainer.classList.add("hidden"),(v._isInterrupterAlreadyViewed()||v._isOldInterrupter)&&v._bannerContainer.classList.add("hidden"),v._isOldInterrupter||(null===r&&"v2"===v._interrupterVersion&&v._removeReactMobileMediumBanner(),localStorage.setItem("EmailSmsMovedToBanner",1),v._setReactBannerText(),document.querySelector("#signup-message-toggle").classList.add("show-new-email-sms-signup-button"),v._bannerContainer.classList.remove("hidden"))):v.closeModal();var n=localStorage.getItem("EmailSmsStep"),a=e||n,o=t||"close";v._ddlService.trackEvent("banner","closed","close banner",!1,{step:a,exitType:o})})),_(this,"_expandBanner",(function(){if(localStorage.removeItem("EmailSmsStep"),!(0,i.tq)())return v.closeBanner().openModal("clicked",!0);v._setReactMobileDrawerFormComponent(v._interrupterVersion),null===document.getElementById("email-sms-banner-text-message-content")&&v._isOldInterrupter&&v._setReactBannerText();var e=localStorage.getItem("EmailSmsMovedToBanner");v._isOldInterrupter||null!==e||v._removeReactMobileMediumBanner(),v._mobileDrawerFormContainer.classList.remove("hidden"),v._bannerContainer.classList.remove("hidden"),document.querySelector("#signup-message-toggle").disabled=!0,v._mobileOverlayClick=document.getElementById("content-overlay"),v._mobileOverlayClick.addEventListener("click",v._handleOverlayClick),v._bannerContainer.classList.add(E.g.Classes.Expanded),v._isBannerExpanded=!0,v._ddlService.trackEvent("banner","open","banner expanded")})),_(this,"_handleOverlayClick",(function(){v._collapseBanner()})),_(this,"_setSignupCookie",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;o.Z.setCookie(E.g.Cookies.OptIn,!0,e,t,r)}));var y=document.getElementById("suppressEmailInterrupter");this._isSuppressed=y&&"1"===y.value;var g=document.getElementById("canadaEmailSmsInterrupter");this._isCanadaSite=g&&"1"===g.value;var h=null===(t=window)||void 0===t||null===(t=t.digitalData)||void 0===t||null===(t=t.page)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t.navState,S=(null===(r=window)||void 0===r||null===(r=r.digitalData)||void 0===r||null===(r=r.page)||void 0===r||null===(r=r.pageInfo)||void 0===r||r.brand,!1);h&&(S="cratekids"===h.toLocaleLowerCase()),this._isKids=S,this._isOldInterrupter=1==o.Z.get("OldEmailSmsInterrupter")&&!0,this._interrupterVersion=null,this._bannerContainer=null,this._isBannerExpanded=!1,this._modalContainer=null,this._modalEmailForm=null,this._bannerTextContainer=null,this._mobileMediumBannerContainer=null,this._mobileDrawerForm=null,this._tempModalHtml=null,this._mobileOverlayClick=null,this._mobileDrawerFormContainer=null,this._tempMobileDrawerFormHtml=null,this._interrupterData=null,this._cmsMessages=null,this._isCb2="cb2"===(null===(b=window)||void 0===b||null===(b=b.digitalData)||void 0===b||null===(b=b.page)||void 0===b||null===(b=b.pageInfo)||void 0===b?void 0:b.brand),this._messagesObject={},this._ddlService=new d.Z("Communication Preferences Interrupter","interrupter type combo",!0,"Core","campaign message"),this._hadServerError=localStorage.getItem("interrupterHadServerError"),this._isCanada=2==(null===(f=window)||void 0===f||null===(f=f.digitalData)||void 0===f||null===(f=f.page)||void 0===f||null===(f=f.pageInfo)||void 0===f?void 0:f.destinationURL.split(".ca").length)}));window.Crate=window.Crate||{},window.Crate.Services=window.Crate.Services||{},window.Crate.Services.EmailSmsInterrupterService=O}},function(e){e.O(0,[6926,2307,234,8947,5461,6364],(function(){return t=35749,e(e.s=t);var t}));e.O()}]);